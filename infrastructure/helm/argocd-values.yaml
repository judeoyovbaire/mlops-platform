# ArgoCD Helm Chart Values (v3.x compatible)

# Global configurations
global:
  # Domain for ArgoCD (update for your environment)
  domain: argocd.example.com

# Server configuration
server:
  replicas: 1

  # Ingress
  ingress:
    enabled: false

  # Resource limits
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi

# Controller configuration
controller:
  replicas: 1
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

# Repo server
repoServer:
  replicas: 1
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi

# Application Set Controller
applicationSet:
  enabled: true
  replicas: 1

# Notifications (optional)
notifications:
  enabled: false

# Dex (SSO - disabled by default)
dex:
  enabled: false

# Redis
redis:
  enabled: true
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 100m
      memory: 128Mi

# Global configurations
configs:
  params:
    # Enable status badge
    server.enable.gzip: true

  cm:
    # Application reconciliation timeout
    timeout.reconciliation: 180s

    # Resource customizations for KServe InferenceService
    resource.customizations: |
      serving.kserve.io/InferenceService:
        health.lua: |
          hs = {}
          if obj.status ~= nil then
            if obj.status.conditions ~= nil then
              for i, condition in ipairs(obj.status.conditions) do
                if condition.type == "Ready" then
                  if condition.status == "True" then
                    hs.status = "Healthy"
                    hs.message = "InferenceService is ready"
                  elseif condition.status == "False" then
                    hs.status = "Degraded"
                    hs.message = condition.message
                  else
                    hs.status = "Progressing"
                    hs.message = "InferenceService is being created"
                  end
                  return hs
                end
              end
            end
          end
          hs.status = "Progressing"
          hs.message = "Waiting for InferenceService status"
          return hs

    # Resource exclusions (ArgoCD 3.x)
    resource.exclusions: |
      - apiGroups:
          - cilium.io
        kinds:
          - CiliumIdentity
        clusters:
          - "*"