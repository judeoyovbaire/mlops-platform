# Promtail Helm Values - Log Shipping Agent
# Chart: grafana/promtail
# Ships container logs from all nodes to Loki for centralized log aggregation

config:
  clients:
    - url: http://loki-gateway.monitoring.svc.cluster.local/loki/api/v1/push

  snippets:
    # Add Kubernetes metadata labels
    pipelineStages:
      - cri: {}
      - labeldrop:
          - filename
      - match:
          selector: '{namespace=~"argo|mlflow|kserve|monitoring|argocd"}'
          stages:
            - static_labels:
                platform: mlops

resources:
  requests:
    cpu: 50m
    memory: 64Mi
  limits:
    cpu: 200m
    memory: 128Mi

tolerations:
  - effect: NoSchedule
    operator: Exists

# ServiceMonitor for Prometheus scraping
serviceMonitor:
  enabled: true
  labels:
    release: prometheus
